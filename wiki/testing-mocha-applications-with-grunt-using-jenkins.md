---
layout: page
title:  "Testing Mocha applications with Grunt using Jenkins"
author: jevon
date:   2014-05-08 20:41:21 +1200
---

[[Grunt]] / [[Jenkins]] / [[Mocha]]

If you are using [[Grunt]] to build your Javascript application and test it using [[Mocha]], you can also enable Jenkins test reporting which will give you graphs and stuff (hopefully).

==Gruntfile==

[code javascript]
mocha: {
  report: {
    options: {
      run: true,
      log: true,
      reporter: 'XUnit',
      urls: [
        'http://localhost:<%= connect.options.port %>/test.html'
      ]
    },
    dest: '.tmp/report.xml'
  }
},
[/code]

And add a `build:report` task to your Grunt task as necessary.

==Jenkins==

*You shouldn't install the <a href="https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin">xUnit plugin for Jenkins</a>.* It is expecting a totally different input format to that provided by the Mocha XUnit reporter.

Instead, you can just use the inbuilt "Publish JUnit test result report" post-build action provided by Jenkins, using the report XML generated by Mocha (e.g. `.tmp/report.xml`).

==Caused by: java.io.FileNotFoundException: . (Is a directory)==

[code]
ERROR: Publisher org.jenkinsci.plugins.xunit.XUnitPublisher aborted due to exception
hudson.util.IOException2: There are some problems during the conversion into JUnit reports: 
	at org.jenkinsci.plugins.xunit.service.XUnitTransformer.invoke(XUnitTransformer.java:153)
	...
Caused by: org.jenkinsci.plugins.xunit.exception.XUnitException: Conversion error Conversion Error
	at org.jenkinsci.plugins.xunit.service.XUnitConversionService.convert(XUnitConversionService.java:64)
	...
Caused by: java.io.FileNotFoundException: . (Is a directory)
[/code]

This is what will happen if you are trying to use the xUnit plugin for Jenkins with the XUnit files generated by the Mocha XUnit reporter. Just use the JUnit plugin.

[[Category:Javascript]]
[[Category:Testing]]